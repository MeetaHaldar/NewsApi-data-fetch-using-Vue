var Z=Object.defineProperty;var j=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var K=(o,a,n)=>a in o?Z(o,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[a]=n,h=(o,a)=>{for(var n in a||(a={}))H.call(a,n)&&K(o,n,a[n]);if(j)for(var n of j(a))J.call(a,n)&&K(o,n,a[n]);return o};var z=(o,a)=>{var n={};for(var v in o)H.call(o,v)&&a.indexOf(v)<0&&(n[v]=o[v]);if(o!=null&&j)for(var v of j(o))a.indexOf(v)<0&&J.call(o,v)&&(n[v]=o[v]);return n};import{u as B,O as ee,k as D,R as q,m as N}from"./render-04a01df5.mjs";import{t as $}from"./use-id-b6e0887a.mjs";import{o as y}from"./keyboard-b81851fc.mjs";import{x as oe,a as g}from"./calculate-active-index-9bbbbe55.mjs";import{t as I}from"./dom-0d1fce75.mjs";import{c as te,p as le,l as U}from"./open-closed-5740cd5c.mjs";import{b as ae}from"./use-resolve-button-type-bc6e1b89.mjs";import{p as ne}from"./use-tree-walker-8519e4e9.mjs";import{v as ue}from"./focus-management-c0b49fb2.mjs";import{g as ie}from"./use-outside-click-30e9fbf7.mjs";import{l as re}from"./visually-hidden-0af70af8.mjs";import{e as se}from"./form-fca0fae1.mjs";import{g as E,h as w,i as C,j as R,w as G,p as pe,k as Q,F as ve,l as _,m as de,n as be,q as V,s as ce}from"./entry-fba3770b.mjs";import"./owner-f2792c55.mjs";var fe=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(fe||{}),me=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(me||{}),xe=(o=>(o[o.Pointer=0]="Pointer",o[o.Other=1]="Other",o))(xe||{});let W=Symbol("ComboboxContext");function F(o){let a=ce(W,null);if(a===null){let n=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,F),n}return a}let De=E({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]},name:{type:String},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(o,{slots:a,attrs:n,emit:v}){let e=w(1),t=w(null),c=w(null),S=w(null),f=w(null),d=w({static:!1,hold:!1}),l=w([]),b=w(null),O=w(1),P=w(!1);function m(i=r=>r){let r=b.value!==null?l.value[b.value]:null,s=ue(i(l.value.slice()),x=>I(x.dataRef.domRef)),u=r?s.indexOf(r):null;return u===-1&&(u=null),{options:s,activeOptionIndex:u}}let k=C(()=>o.modelValue),A=C(()=>o.multiple?1:0),M=C(()=>o.nullable),p={comboboxState:e,value:k,mode:A,nullable:M,inputRef:c,labelRef:t,buttonRef:S,optionsRef:f,disabled:C(()=>o.disabled),options:l,change(i){v("update:modelValue",i)},activeOptionIndex:C(()=>{if(P.value&&b.value===null&&l.value.length>0){let i=l.value.findIndex(r=>!r.dataRef.disabled);if(i!==-1)return i}return b.value}),activationTrigger:O,inputPropsRef:w({displayValue:void 0}),optionsPropsRef:d,closeCombobox(){P.value=!1,!o.disabled&&e.value!==1&&(e.value=1,b.value=null)},openCombobox(){if(P.value=!0,o.disabled||e.value===0)return;let i=l.value.findIndex(r=>{let s=R(r.dataRef.value);return B(A.value,{[0]:()=>R(p.value.value)===R(s),[1]:()=>R(p.value.value).includes(R(s))})});i!==-1&&(b.value=i),e.value=0},goToOption(i,r,s){if(P.value=!1,o.disabled||f.value&&!d.value.static&&e.value===1)return;let u=m();if(u.activeOptionIndex===null){let T=u.options.findIndex(L=>!L.dataRef.disabled);T!==-1&&(u.activeOptionIndex=T)}let x=oe(i===g.Specific?{focus:g.Specific,id:r}:{focus:i},{resolveItems:()=>u.options,resolveActiveIndex:()=>u.activeOptionIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});b.value=x,O.value=s!=null?s:1,l.value=u.options},syncInputValue(){var i;let r=p.value.value;if(!I(p.inputRef))return;let s=p.inputPropsRef.value.displayValue;typeof s=="function"?p.inputRef.value.value=(i=s(r))!=null?i:"":typeof r=="string"?p.inputRef.value.value=r:p.inputRef.value.value=""},selectOption(i){let r=l.value.find(u=>u.id===i);if(!r)return;let{dataRef:s}=r;v("update:modelValue",B(A.value,{[0]:()=>s.value,[1]:()=>{let u=R(p.value.value).slice(),x=R(s.value),T=u.indexOf(x);return T===-1?u.push(x):u.splice(T,1),u}})),p.syncInputValue()},selectActiveOption(){if(p.activeOptionIndex.value===null)return;let{dataRef:i,id:r}=l.value[p.activeOptionIndex.value];v("update:modelValue",B(A.value,{[0]:()=>i.value,[1]:()=>{let s=R(p.value.value).slice(),u=R(i.value),x=s.indexOf(u);return x===-1?s.push(u):s.splice(x,1),s}})),p.syncInputValue(),p.goToOption(g.Specific,r)},registerOption(i,r){let s={id:i,dataRef:r},u=m(x=>[...x,s]);if(b.value===null){let x=r.value.value;B(A.value,{[0]:()=>R(p.value.value)===R(x),[1]:()=>R(p.value.value).includes(R(x))})&&(u.activeOptionIndex=u.options.indexOf(s))}l.value=u.options,b.value=u.activeOptionIndex,O.value=1},unregisterOption(i){let r=m(s=>{let u=s.findIndex(x=>x.id===i);return u!==-1&&s.splice(u,1),s});l.value=r.options,b.value=r.activeOptionIndex,O.value=1}};ie([c,S,f],()=>{e.value===0&&p.closeCombobox()}),G([p.value,p.inputRef],()=>p.syncInputValue(),{immediate:!0}),G(p.comboboxState,i=>{i===1&&p.syncInputValue()},{immediate:!0}),pe(W,p),te(C(()=>B(e.value,{[0]:U.Open,[1]:U.Closed})));let X=C(()=>p.activeOptionIndex.value===null?null:l.value[p.activeOptionIndex.value].dataRef.value);return()=>{let T=o,{name:i,modelValue:r,disabled:s}=T,u=z(T,["name","modelValue","disabled"]),x={open:e.value===0,disabled:s,activeIndex:p.activeOptionIndex.value,activeOption:X.value};return Q(ve,[...i!=null&&r!=null?se({[i]:r}).map(([L,Y])=>Q(re,ee({key:L,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:L,value:Y}))):[],D({props:h(h({},n),q(u,["nullable","multiple","onUpdate:modelValue"])),slot:x,slots:a,attrs:n,name:"Combobox"})])}}}),Ee=E({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"}},setup(o,{attrs:a,slots:n}){let v=F("ComboboxLabel"),e=`headlessui-combobox-label-${$()}`;function t(){var c;(c=I(v.inputRef))==null||c.focus({preventScroll:!0})}return()=>{let c={open:v.comboboxState.value===0,disabled:v.disabled.value},S={id:e,ref:v.labelRef,onClick:t};return D({props:h(h({},o),S),slot:c,attrs:a,slots:n,name:"ComboboxLabel"})}}}),Fe=E({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"}},setup(o,{attrs:a,slots:n,expose:v}){let e=F("ComboboxButton"),t=`headlessui-combobox-button-${$()}`;v({el:e.buttonRef,$el:e.buttonRef});function c(d){e.disabled.value||(e.comboboxState.value===0?e.closeCombobox():(d.preventDefault(),e.openCombobox()),V(()=>{var l;return(l=I(e.inputRef))==null?void 0:l.focus({preventScroll:!0})}))}function S(d){switch(d.key){case y.ArrowDown:d.preventDefault(),d.stopPropagation(),e.comboboxState.value===1&&(e.openCombobox(),V(()=>{e.value.value||e.goToOption(g.First)})),V(()=>{var l;return(l=e.inputRef.value)==null?void 0:l.focus({preventScroll:!0})});return;case y.ArrowUp:d.preventDefault(),d.stopPropagation(),e.comboboxState.value===1&&(e.openCombobox(),V(()=>{e.value.value||e.goToOption(g.Last)})),V(()=>{var l;return(l=e.inputRef.value)==null?void 0:l.focus({preventScroll:!0})});return;case y.Escape:d.preventDefault(),e.optionsRef.value&&!e.optionsPropsRef.value.static&&d.stopPropagation(),e.closeCombobox(),V(()=>{var l;return(l=e.inputRef.value)==null?void 0:l.focus({preventScroll:!0})});return}}let f=ae(C(()=>({as:o.as,type:a.type})),e.buttonRef);return()=>{var d,l;let b={open:e.comboboxState.value===0,disabled:e.disabled.value},O={ref:e.buttonRef,id:t,type:f.value,tabindex:"-1","aria-haspopup":!0,"aria-controls":(d=I(e.optionsRef))==null?void 0:d.id,"aria-expanded":e.disabled.value?void 0:e.comboboxState.value===0,"aria-labelledby":e.labelRef.value?[(l=I(e.labelRef))==null?void 0:l.id,t].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:S,onClick:c};return D({props:h(h({},o),O),slot:b,attrs:a,slots:n,name:"ComboboxButton"})}}}),$e=E({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function}},emits:{change:o=>!0},setup(o,{emit:a,attrs:n,slots:v,expose:e}){let t=F("ComboboxInput"),c=`headlessui-combobox-input-${$()}`;t.inputPropsRef=C(()=>o),e({el:t.inputRef,$el:t.inputRef});function S(l){switch(l.key){case y.Backspace:case y.Delete:if(t.mode.value!==0||!t.nullable.value)return;let b=l.currentTarget;requestAnimationFrame(()=>{if(b.value===""){t.change(null);let O=I(t.optionsRef);O&&(O.scrollTop=0),t.goToOption(g.Nothing)}});break;case y.Enter:if(t.comboboxState.value!==0)return;if(l.preventDefault(),l.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case y.ArrowDown:return l.preventDefault(),l.stopPropagation(),B(t.comboboxState.value,{[0]:()=>t.goToOption(g.Next),[1]:()=>{t.openCombobox(),V(()=>{t.value.value||t.goToOption(g.First)})}});case y.ArrowUp:return l.preventDefault(),l.stopPropagation(),B(t.comboboxState.value,{[0]:()=>t.goToOption(g.Previous),[1]:()=>{t.openCombobox(),V(()=>{t.value.value||t.goToOption(g.Last)})}});case y.Home:case y.PageUp:return l.preventDefault(),l.stopPropagation(),t.goToOption(g.First);case y.End:case y.PageDown:return l.preventDefault(),l.stopPropagation(),t.goToOption(g.Last);case y.Escape:l.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&l.stopPropagation(),t.closeCombobox();break;case y.Tab:t.selectActiveOption(),t.closeCombobox();break}}function f(l){a("change",l)}function d(l){t.openCombobox(),a("change",l)}return()=>{var l,b,O,P,m;let k={open:t.comboboxState.value===0},A={"aria-controls":(l=t.optionsRef.value)==null?void 0:l.id,"aria-expanded":t.disabled?void 0:t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null||(b=t.options.value[t.activeOptionIndex.value])==null?void 0:b.id,"aria-multiselectable":t.mode.value===1?!0:void 0,"aria-labelledby":(m=(O=I(t.labelRef))==null?void 0:O.id)!=null?m:(P=I(t.buttonRef))==null?void 0:P.id,id:c,onKeydown:S,onChange:f,onInput:d,role:"combobox",type:"text",tabIndex:0,ref:t.inputRef},M=q(o,["displayValue"]);return D({props:h(h({},M),A),slot:k,attrs:n,slots:v,features:N.RenderStrategy|N.Static,name:"ComboboxInput"})}}}),Le=E({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:a,slots:n,expose:v}){let e=F("ComboboxOptions"),t=`headlessui-combobox-options-${$()}`;v({el:e.optionsRef,$el:e.optionsRef}),_(()=>{e.optionsPropsRef.value.static=o.static}),_(()=>{e.optionsPropsRef.value.hold=o.hold});let c=le(),S=C(()=>c!==null?c.value===U.Open:e.comboboxState.value===0);return ne({container:C(()=>I(e.optionsRef)),enabled:C(()=>e.comboboxState.value===0),accept(f){return f.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}}),()=>{var f,d,l,b;let O={open:e.comboboxState.value===0},P={"aria-activedescendant":e.activeOptionIndex.value===null||(f=e.options.value[e.activeOptionIndex.value])==null?void 0:f.id,"aria-labelledby":(b=(d=I(e.labelRef))==null?void 0:d.id)!=null?b:(l=I(e.buttonRef))==null?void 0:l.id,id:t,ref:e.optionsRef,role:"listbox"},m=q(o,["hold"]);return D({props:h(h({},m),P),slot:O,attrs:a,slots:n,features:N.RenderStrategy|N.Static,visible:S.value,name:"ComboboxOptions"})}}}),je=E({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(o,{slots:a,attrs:n,expose:v}){let e=F("ComboboxOption"),t=`headlessui-combobox-option-${$()}`,c=w(null);v({el:c,$el:c});let S=C(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===t:!1),f=C(()=>B(e.mode.value,{[0]:()=>R(e.value.value)===R(o.value),[1]:()=>R(e.value.value).includes(R(o.value))})),d=C(()=>({disabled:o.disabled,value:o.value,domRef:c}));de(()=>e.registerOption(t,d)),be(()=>e.unregisterOption(t)),_(()=>{e.comboboxState.value===0&&(!S.value||e.activationTrigger.value!==0&&V(()=>{var m,k;return(k=(m=I(c))==null?void 0:m.scrollIntoView)==null?void 0:k.call(m,{block:"nearest"})}))});function l(m){if(o.disabled)return m.preventDefault();e.selectOption(t),e.mode.value===0&&(e.closeCombobox(),V(()=>{var k;return(k=I(e.inputRef))==null?void 0:k.focus({preventScroll:!0})}))}function b(){if(o.disabled)return e.goToOption(g.Nothing);e.goToOption(g.Specific,t)}function O(){o.disabled||S.value||e.goToOption(g.Specific,t,0)}function P(){o.disabled||!S.value||e.optionsPropsRef.value.hold||e.goToOption(g.Nothing)}return()=>{let{disabled:m}=o,k={active:S.value,selected:f.value,disabled:m},A={id:t,ref:c,role:"option",tabIndex:m===!0?void 0:-1,"aria-disabled":m===!0?!0:void 0,"aria-selected":f.value===!0?f.value:void 0,disabled:void 0,onClick:l,onFocus:b,onPointermove:O,onMousemove:O,onPointerleave:P,onMouseleave:P};return D({props:h(h({},o),A),slot:k,attrs:n,slots:a,name:"ComboboxOption"})}}});export{De as Combobox,Fe as ComboboxButton,$e as ComboboxInput,Ee as ComboboxLabel,je as ComboboxOption,Le as ComboboxOptions};
