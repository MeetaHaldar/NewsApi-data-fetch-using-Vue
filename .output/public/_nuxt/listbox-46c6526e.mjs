var G=Object.defineProperty;var A=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var N=(t,u,n)=>u in t?G(t,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[u]=n,S=(t,u)=>{for(var n in u||(u={}))M.call(u,n)&&N(t,n,u[n]);if(A)for(var n of A(u))U.call(u,n)&&N(t,n,u[n]);return t};var q=(t,u)=>{var n={};for(var r in t)M.call(t,r)&&u.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&A)for(var r of A(t))u.indexOf(r)<0&&U.call(t,r)&&(n[r]=t[r]);return n};import{u as D,O as J,k as B,R as $,m as K}from"./render-04a01df5.mjs";import{t as V}from"./use-id-b6e0887a.mjs";import{o as f}from"./keyboard-b81851fc.mjs";import{x as X,a as x}from"./calculate-active-index-9bbbbe55.mjs";import{t as m}from"./dom-0d1fce75.mjs";import{c as Y,p as Z,l as F}from"./open-closed-5740cd5c.mjs";import{b as _}from"./use-resolve-button-type-bc6e1b89.mjs";import{v as ee,S as te,b as le}from"./focus-management-c0b49fb2.mjs";import{g as ae}from"./use-outside-click-30e9fbf7.mjs";import{l as oe}from"./visually-hidden-0af70af8.mjs";import{e as ie}from"./form-fca0fae1.mjs";import{g as C,h as y,i as L,p as ne,k as Q,F as ue,m as E,n as se,w as re,l as pe,q as I,s as ve,j as w}from"./entry-fba3770b.mjs";import"./owner-f2792c55.mjs";var de=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(de||{}),ce=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(ce||{}),be=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(be||{});function fe(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let H=Symbol("ListboxContext");function j(t){let u=ve(H,null);if(u===null){let n=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,j),n}return u}let Pe=C({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:u,attrs:n,emit:r}){let e=y(1),b=y(null),v=y(null),O=y(null),p=y([]),g=y(""),l=y(null),a=y(1);function R(o=i=>i){let i=l.value!==null?p.value[l.value]:null,s=ee(o(p.value.slice()),h=>m(h.dataRef.domRef)),c=i?s.indexOf(i):null;return c===-1&&(c=null),{options:s,activeOptionIndex:c}}let T=L(()=>t.modelValue),k=L(()=>t.multiple?1:0),d={listboxState:e,value:T,mode:k,orientation:L(()=>t.horizontal?"horizontal":"vertical"),labelRef:b,buttonRef:v,optionsRef:O,disabled:L(()=>t.disabled),options:p,searchQuery:g,activeOptionIndex:l,activationTrigger:a,closeListbox(){t.disabled||e.value!==1&&(e.value=1,l.value=null)},openListbox(){t.disabled||e.value!==0&&(e.value=0)},goToOption(o,i,s){if(t.disabled||e.value===1)return;let c=R(),h=X(o===x.Specific?{focus:x.Specific,id:i}:{focus:o},{resolveItems:()=>c.options,resolveActiveIndex:()=>c.activeOptionIndex,resolveId:P=>P.id,resolveDisabled:P=>P.dataRef.disabled});g.value="",l.value=h,a.value=s!=null?s:1,p.value=c.options},search(o){if(t.disabled||e.value===1)return;let i=g.value!==""?0:1;g.value+=o.toLowerCase();let s=(l.value!==null?p.value.slice(l.value+i).concat(p.value.slice(0,l.value+i)):p.value).find(h=>h.dataRef.textValue.startsWith(g.value)&&!h.dataRef.disabled),c=s?p.value.indexOf(s):-1;c===-1||c===l.value||(l.value=c,a.value=1)},clearSearch(){t.disabled||e.value!==1&&g.value!==""&&(g.value="")},registerOption(o,i){let s=R(c=>[...c,{id:o,dataRef:i}]);p.value=s.options,l.value=s.activeOptionIndex},unregisterOption(o){let i=R(s=>{let c=s.findIndex(h=>h.id===o);return c!==-1&&s.splice(c,1),s});p.value=i.options,l.value=i.activeOptionIndex,a.value=1},select(o){t.disabled||r("update:modelValue",D(k.value,{[0]:()=>o,[1]:()=>{let i=w(d.value.value).slice(),s=w(o),c=i.indexOf(s);return c===-1?i.push(s):i.splice(c,1),i}}))}};return ae([v,O],(o,i)=>{var s;e.value===0&&(d.closeListbox(),te(i,le.Loose)||(o.preventDefault(),(s=m(v))==null||s.focus()))}),ne(H,d),Y(L(()=>D(e.value,{[0]:F.Open,[1]:F.Closed}))),()=>{let P=t,{name:o,modelValue:i,disabled:s}=P,c=q(P,["name","modelValue","disabled"]),h={open:e.value===0,disabled:s};return Q(ue,[...o!=null&&i!=null?ie({[o]:i}).map(([z,W])=>Q(oe,J({key:z,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:z,value:W}))):[],B({props:S(S({},n),$(c,["onUpdate:modelValue","horizontal","multiple"])),slot:h,slots:u,attrs:n,name:"Listbox"})])}}}),Be=C({name:"ListboxLabel",props:{as:{type:[Object,String],default:"label"}},setup(t,{attrs:u,slots:n}){let r=j("ListboxLabel"),e=`headlessui-listbox-label-${V()}`;function b(){var v;(v=m(r.buttonRef))==null||v.focus({preventScroll:!0})}return()=>{let v={open:r.listboxState.value===0,disabled:r.disabled.value},O={id:e,ref:r.labelRef,onClick:b};return B({props:S(S({},t),O),slot:v,attrs:u,slots:n,name:"ListboxLabel"})}}}),Ce=C({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"}},setup(t,{attrs:u,slots:n,expose:r}){let e=j("ListboxButton"),b=`headlessui-listbox-button-${V()}`;r({el:e.buttonRef,$el:e.buttonRef});function v(l){switch(l.key){case f.Space:case f.Enter:case f.ArrowDown:l.preventDefault(),e.openListbox(),I(()=>{var a;(a=m(e.optionsRef))==null||a.focus({preventScroll:!0}),e.value.value||e.goToOption(x.First)});break;case f.ArrowUp:l.preventDefault(),e.openListbox(),I(()=>{var a;(a=m(e.optionsRef))==null||a.focus({preventScroll:!0}),e.value.value||e.goToOption(x.Last)});break}}function O(l){switch(l.key){case f.Space:l.preventDefault();break}}function p(l){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),I(()=>{var a;return(a=m(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})})):(l.preventDefault(),e.openListbox(),fe(()=>{var a;return(a=m(e.optionsRef))==null?void 0:a.focus({preventScroll:!0})})))}let g=_(L(()=>({as:t.as,type:u.type})),e.buttonRef);return()=>{var l,a;let R={open:e.listboxState.value===0,disabled:e.disabled.value},T={ref:e.buttonRef,id:b,type:g.value,"aria-haspopup":!0,"aria-controls":(l=m(e.optionsRef))==null?void 0:l.id,"aria-expanded":e.disabled.value?void 0:e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(a=m(e.labelRef))==null?void 0:a.id,b].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:v,onKeyup:O,onClick:p};return B({props:S(S({},t),T),slot:R,attrs:u,slots:n,name:"ListboxButton"})}}}),je=C({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(t,{attrs:u,slots:n,expose:r}){let e=j("ListboxOptions"),b=`headlessui-listbox-options-${V()}`,v=y(null);r({el:e.optionsRef,$el:e.optionsRef});function O(l){switch(v.value&&clearTimeout(v.value),l.key){case f.Space:if(e.searchQuery.value!=="")return l.preventDefault(),l.stopPropagation(),e.search(l.key);case f.Enter:if(l.preventDefault(),l.stopPropagation(),e.activeOptionIndex.value!==null){let a=e.options.value[e.activeOptionIndex.value];e.select(a.dataRef.value)}e.mode.value===0&&(e.closeListbox(),I(()=>{var a;return(a=m(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})}));break;case D(e.orientation.value,{vertical:f.ArrowDown,horizontal:f.ArrowRight}):return l.preventDefault(),l.stopPropagation(),e.goToOption(x.Next);case D(e.orientation.value,{vertical:f.ArrowUp,horizontal:f.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),e.goToOption(x.Previous);case f.Home:case f.PageUp:return l.preventDefault(),l.stopPropagation(),e.goToOption(x.First);case f.End:case f.PageDown:return l.preventDefault(),l.stopPropagation(),e.goToOption(x.Last);case f.Escape:l.preventDefault(),l.stopPropagation(),e.closeListbox(),I(()=>{var a;return(a=m(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})});break;case f.Tab:l.preventDefault(),l.stopPropagation();break;default:l.key.length===1&&(e.search(l.key),v.value=setTimeout(()=>e.clearSearch(),350));break}}let p=Z(),g=L(()=>p!==null?p.value===F.Open:e.listboxState.value===0);return()=>{var l,a,R,T;let k={open:e.listboxState.value===0},d={"aria-activedescendant":e.activeOptionIndex.value===null||(l=e.options.value[e.activeOptionIndex.value])==null?void 0:l.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(T=(a=m(e.labelRef))==null?void 0:a.id)!=null?T:(R=m(e.buttonRef))==null?void 0:R.id,"aria-orientation":e.orientation.value,id:b,onKeydown:O,role:"listbox",tabIndex:0,ref:e.optionsRef};return B({props:S(S({},t),d),slot:k,attrs:u,slots:n,features:K.RenderStrategy|K.Static,visible:g.value,name:"ListboxOptions"})}}}),Ae=C({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(t,{slots:u,attrs:n,expose:r}){let e=j("ListboxOption"),b=`headlessui-listbox-option-${V()}`,v=y(null);r({el:v,$el:v});let O=L(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===b:!1),p=L(()=>D(e.mode.value,{[0]:()=>w(e.value.value)===w(t.value),[1]:()=>w(e.value.value).includes(w(t.value))})),g=L(()=>D(e.mode.value,{[1]:()=>{var d;let o=w(e.value.value);return((d=e.options.value.find(i=>o.includes(i.dataRef.value)))==null?void 0:d.id)===b},[0]:()=>p.value})),l=L(()=>({disabled:t.disabled,value:t.value,textValue:"",domRef:v}));E(()=>{var d,o;let i=(o=(d=m(v))==null?void 0:d.textContent)==null?void 0:o.toLowerCase().trim();i!==void 0&&(l.value.textValue=i)}),E(()=>e.registerOption(b,l)),se(()=>e.unregisterOption(b)),E(()=>{re([e.listboxState,p],()=>{e.listboxState.value===0&&(!p.value||D(e.mode.value,{[1]:()=>{g.value&&e.goToOption(x.Specific,b)},[0]:()=>{e.goToOption(x.Specific,b)}}))},{immediate:!0})}),pe(()=>{e.listboxState.value===0&&(!O.value||e.activationTrigger.value!==0&&I(()=>{var d,o;return(o=(d=m(v))==null?void 0:d.scrollIntoView)==null?void 0:o.call(d,{block:"nearest"})}))});function a(d){if(t.disabled)return d.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),I(()=>{var o;return(o=m(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function R(){if(t.disabled)return e.goToOption(x.Nothing);e.goToOption(x.Specific,b)}function T(){t.disabled||O.value||e.goToOption(x.Specific,b,0)}function k(){t.disabled||!O.value||e.goToOption(x.Nothing)}return()=>{let{disabled:d}=t,o={active:O.value,selected:p.value,disabled:d},i={id:b,ref:v,role:"option",tabIndex:d===!0?void 0:-1,"aria-disabled":d===!0?!0:void 0,"aria-selected":p.value===!0?p.value:void 0,disabled:void 0,onClick:a,onFocus:R,onPointermove:T,onMousemove:T,onPointerleave:k,onMouseleave:k};return B({props:S(S({},$(t,["value","disabled"])),i),slot:o,attrs:n,slots:u,name:"ListboxOption"})}}});export{Pe as Listbox,Ce as ListboxButton,Be as ListboxLabel,Ae as ListboxOption,je as ListboxOptions};
