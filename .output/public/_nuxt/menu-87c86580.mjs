var L=Object.defineProperty,N=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var C=(a,u,i)=>u in a?L(a,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[u]=i,y=(a,u)=>{for(var i in u||(u={}))K.call(u,i)&&C(a,i,u[i]);if(E)for(var i of E(u))U.call(u,i)&&C(a,i,u[i]);return a},O=(a,u)=>N(a,j(u));import{k as h,m as A,u as V}from"./render-04a01df5.mjs";import{t as P}from"./use-id-b6e0887a.mjs";import{o as c}from"./keyboard-b81851fc.mjs";import{x as q,a as g}from"./calculate-active-index-9bbbbe55.mjs";import{t as d}from"./dom-0d1fce75.mjs";import{p as _}from"./use-tree-walker-8519e4e9.mjs";import{c as J,p as Q,l as D}from"./open-closed-5740cd5c.mjs";import{b as W}from"./use-resolve-button-type-bc6e1b89.mjs";import{v as z,S as H,b as G}from"./focus-management-c0b49fb2.mjs";import{g as X}from"./use-outside-click-30e9fbf7.mjs";import{g as T,h as S,p as Y,i as M,m as F,n as Z,l as $,q as x,s as ee}from"./entry-fba3770b.mjs";import"./owner-f2792c55.mjs";var te=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(te||{}),ae=(a=>(a[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a))(ae||{});function ne(a){requestAnimationFrame(()=>requestAnimationFrame(a))}let B=Symbol("MenuContext");function k(a){let u=ee(B,null);if(u===null){let i=new Error(`<${a} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,k),i}return u}let be=T({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(a,{slots:u,attrs:i}){let I=S(1),e=S(null),f=S(null),r=S([]),m=S(""),v=S(null),b=S(1);function s(o=n=>n){let n=v.value!==null?r.value[v.value]:null,l=z(o(r.value.slice()),R=>d(R.dataRef.domRef)),p=n?l.indexOf(n):null;return p===-1&&(p=null),{items:l,activeItemIndex:p}}let t={menuState:I,buttonRef:e,itemsRef:f,items:r,searchQuery:m,activeItemIndex:v,activationTrigger:b,closeMenu:()=>{I.value=1,v.value=null},openMenu:()=>I.value=0,goToItem(o,n,l){let p=s(),R=q(o===g.Specific?{focus:g.Specific,id:n}:{focus:o},{resolveItems:()=>p.items,resolveActiveIndex:()=>p.activeItemIndex,resolveId:w=>w.id,resolveDisabled:w=>w.dataRef.disabled});m.value="",v.value=R,b.value=l!=null?l:1,r.value=p.items},search(o){let n=m.value!==""?0:1;m.value+=o.toLowerCase();let l=(v.value!==null?r.value.slice(v.value+n).concat(r.value.slice(0,v.value+n)):r.value).find(R=>R.dataRef.textValue.startsWith(m.value)&&!R.dataRef.disabled),p=l?r.value.indexOf(l):-1;p===-1||p===v.value||(v.value=p,b.value=1)},clearSearch(){m.value=""},registerItem(o,n){let l=s(p=>[...p,{id:o,dataRef:n}]);r.value=l.items,v.value=l.activeItemIndex,b.value=1},unregisterItem(o){let n=s(l=>{let p=l.findIndex(R=>R.id===o);return p!==-1&&l.splice(p,1),l});r.value=n.items,v.value=n.activeItemIndex,b.value=1}};return X([e,f],(o,n)=>{var l;I.value===0&&(t.closeMenu(),H(n,G.Loose)||(o.preventDefault(),(l=d(e))==null||l.focus()))}),Y(B,t),J(M(()=>V(I.value,{[0]:D.Open,[1]:D.Closed}))),()=>{let o={open:I.value===0};return h({props:a,slot:o,slots:u,attrs:i,name:"Menu"})}}}),ge=T({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"}},setup(a,{attrs:u,slots:i,expose:I}){let e=k("MenuButton"),f=`headlessui-menu-button-${P()}`;I({el:e.buttonRef,$el:e.buttonRef});function r(s){switch(s.key){case c.Space:case c.Enter:case c.ArrowDown:s.preventDefault(),s.stopPropagation(),e.openMenu(),x(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.First)});break;case c.ArrowUp:s.preventDefault(),s.stopPropagation(),e.openMenu(),x(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.Last)});break}}function m(s){switch(s.key){case c.Space:s.preventDefault();break}}function v(s){a.disabled||(e.menuState.value===0?(e.closeMenu(),x(()=>{var t;return(t=d(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(s.preventDefault(),s.stopPropagation(),e.openMenu(),ne(()=>{var t;return(t=d(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let b=W(M(()=>({as:a.as,type:u.type})),e.buttonRef);return()=>{var s;let t={open:e.menuState.value===0},o={ref:e.buttonRef,id:f,type:b.value,"aria-haspopup":!0,"aria-controls":(s=d(e.itemsRef))==null?void 0:s.id,"aria-expanded":a.disabled?void 0:e.menuState.value===0,onKeydown:r,onKeyup:m,onClick:v};return h({props:y(y({},a),o),slot:t,attrs:u,slots:i,name:"MenuButton"})}}}),Se=T({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(a,{attrs:u,slots:i,expose:I}){let e=k("MenuItems"),f=`headlessui-menu-items-${P()}`,r=S(null);I({el:e.itemsRef,$el:e.itemsRef}),_({container:M(()=>d(e.itemsRef)),enabled:M(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function m(t){var o;switch(r.value&&clearTimeout(r.value),t.key){case c.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case c.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let n=e.items.value[e.activeItemIndex.value];(o=d(n.dataRef.domRef))==null||o.click()}e.closeMenu(),x(()=>{var n;return(n=d(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case c.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Next);case c.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Previous);case c.Home:case c.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.First);case c.End:case c.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Last);case c.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),x(()=>{var n;return(n=d(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case c.Tab:t.preventDefault(),t.stopPropagation();break;default:t.key.length===1&&(e.search(t.key),r.value=setTimeout(()=>e.clearSearch(),350));break}}function v(t){switch(t.key){case c.Space:t.preventDefault();break}}let b=Q(),s=M(()=>b!==null?b.value===D.Open:e.menuState.value===0);return()=>{var t,o;let n={open:e.menuState.value===0},l={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(o=d(e.buttonRef))==null?void 0:o.id,id:f,onKeydown:m,onKeyup:v,role:"menu",tabIndex:0,ref:e.itemsRef};return h({props:y(y({},a),l),slot:n,attrs:u,slots:i,features:A.RenderStrategy|A.Static,visible:s.value,name:"MenuItems"})}}}),Re=T({name:"MenuItem",props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1}},setup(a,{slots:u,attrs:i,expose:I}){let e=k("MenuItem"),f=`headlessui-menu-item-${P()}`,r=S(null);I({el:r,$el:r});let m=M(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===f:!1),v=M(()=>({disabled:a.disabled,textValue:"",domRef:r}));F(()=>{var n,l;let p=(l=(n=d(r))==null?void 0:n.textContent)==null?void 0:l.toLowerCase().trim();p!==void 0&&(v.value.textValue=p)}),F(()=>e.registerItem(f,v)),Z(()=>e.unregisterItem(f)),$(()=>{e.menuState.value===0&&(!m.value||e.activationTrigger.value!==0&&x(()=>{var n,l;return(l=(n=d(r))==null?void 0:n.scrollIntoView)==null?void 0:l.call(n,{block:"nearest"})}))});function b(n){if(a.disabled)return n.preventDefault();e.closeMenu(),x(()=>{var l;return(l=d(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})})}function s(){if(a.disabled)return e.goToItem(g.Nothing);e.goToItem(g.Specific,f)}function t(){a.disabled||m.value||e.goToItem(g.Specific,f,0)}function o(){a.disabled||!m.value||e.goToItem(g.Nothing)}return()=>{let{disabled:n}=a,l={active:m.value,disabled:n};return h({props:O(y({},a),{id:f,ref:r,role:"menuitem",tabIndex:n===!0?void 0:-1,"aria-disabled":n===!0?!0:void 0,onClick:b,onFocus:s,onPointermove:t,onMousemove:t,onPointerleave:o,onMouseleave:o}),slot:l,attrs:i,slots:u,name:"MenuItem"})}}});export{be as Menu,ge as MenuButton,Re as MenuItem,Se as MenuItems};
